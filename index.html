<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>zksync-wtf — instant lookup</title>
  <style>
    :root {
      --bg: 248 248 250;          /* light */
      --fg: 20 23 28;
      --muted: 105 112 125;
      --accent: 88 101 242;       /* zksync-ish violet */
      --accent-2: 45 212 191;     /* mint */
      --card: 255 255 255;
      --ring: 0 0 0 / 0.08;
      --shadow: 0 10px 30px rgba(0,0,0,.08);
    }
    @media (prefers-color-scheme: dark) {
      :root {
        --bg: 14 16 20;
        --fg: 234 236 240;
        --muted: 151 156 169;
        --accent: 145 130 255;
        --accent-2: 34 197 190;
        --card: 22 24 31;
        --ring: 255 255 255 / 0.1;
        --shadow: 0 10px 30px rgba(0,0,0,.35);
      }
    }
    * { box-sizing: border-box; }
    html, body { height: 100%; }
    body {
      margin: 0; font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Inter, Noto Sans, Helvetica, Arial, sans-serif;
      color: rgb(var(--fg));
      background: radial-gradient(1200px 600px at 10% 0%, rgba(145,130,255,.12), transparent 60%),
                  radial-gradient(900px 500px at 100% 10%, rgba(34,197,190,.12), transparent 50%),
                  rgb(var(--bg));
      -webkit-font-smoothing: antialiased; text-rendering: optimizeLegibility;
    }
    .wrap {
      max-width: 980px; margin: 0 auto; padding: 28px 18px 56px;
    }
    header { display:flex; align-items:center; gap:14px; margin-bottom: 18px; }
    .logo {
      width: 40px; height: 40px; display:grid; place-items:center; border-radius: 12px;
      background: linear-gradient(135deg, rgba(145,130,255,.3), rgba(34,197,190,.3));
      box-shadow: var(--shadow);
    }
    .logo svg { width: 22px; height: 22px; }
    h1 { font-size: clamp(20px, 4vw, 28px); margin: 0; letter-spacing: .2px; }
    .sub { color: rgb(var(--muted)); font-size: 14px; margin-top: 2px; }

    .search {
      position: sticky; top: 0; z-index: 10; padding-top: 6px; padding-bottom: 10px;
      backdrop-filter: blur(6px);
      background: linear-gradient(to bottom, rgba(255,255,255,.5), rgba(255,255,255,0))
                  ,transparent;
    }
    @media (prefers-color-scheme: dark) {
      .search { background: linear-gradient(to bottom, rgba(0,0,0,.35), transparent); }
    }
    .input-shell {
      display:flex; align-items:center; gap:10px; width: 100%;
      background: rgba(255,255,255,.7);
      border: 1px solid color-mix(in oklab, rgb(var(--fg)) 12%, transparent);
      padding: 10px 12px; border-radius: 14px; box-shadow: var(--shadow);
    }
    @media (prefers-color-scheme: dark) {
      .input-shell { background: rgba(255,255,255,.06); }
    }
    .input-shell:focus-within { outline: 3px solid color-mix(in oklab, rgb(var(--accent)) 25%, transparent); }
    .input-shell svg { flex: none; width: 18px; height: 18px; opacity: .7; }
    #q {
      flex: 1; border: 0; outline: 0; background: transparent; font-size: 16px; padding: 6px 2px;
      color: inherit;
    }

    .results { margin-top: 18px; }
    .table { width: 100%; border-collapse: collapse; }
    .thead { position: sticky; top: 74px; z-index: 5; }
    .thead th { text-align:left; font-size: 12px; font-weight: 600; color: rgb(var(--muted)); padding: 10px 8px; letter-spacing: .3px; }
    .tbody tr { background: rgba(255,255,255,.5); }
    @media (prefers-color-scheme: dark) { .tbody tr { background: rgba(255,255,255,.04); } }
    .tbody tr + tr { border-top: 1px solid color-mix(in oklab, rgb(var(--fg)) 12%, transparent); }
    td { padding: 12px 8px; vertical-align: middle; }
    td.key { font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace; font-size: 12.5px; }
    td.value { font-weight: 600; }

    .muted { color: rgb(var(--muted)); font-size: 12px; }
    .hint { margin-top: 8px; }
    .pill { display:inline-flex; align-items:center; gap:8px; font-size: 12px; padding: 6px 10px; border-radius: 999px; background: rgba(145,130,255,.12); border: 1px solid color-mix(in oklab, rgb(var(--accent)) 35%, transparent); }

    .btn-ghost { display:inline-grid; place-items:center; width: 34px; height: 34px; border-radius: 10px; border: 1px solid color-mix(in oklab, rgb(var(--fg)) 12%, transparent); background: rgba(255,255,255,.55); cursor: pointer; }
    @media (prefers-color-scheme: dark) { .btn-ghost { background: rgba(255,255,255,.06); } }
    .btn-ghost:hover { transform: translateY(-1px); }

    /* Tooltip */
    .tooltip { position: relative; }
    .tooltip [data-tip]::after {
      content: attr(data-tip);
      position: absolute; z-index: 20; inset-inline-start: 50%; transform: translateX(-50%);
      bottom: calc(100% + 10px); min-width: 220px; max-width: min(520px, 70vw);
      background: rgb(var(--card)); color: rgb(var(--fg));
      border: 1px solid color-mix(in oklab, rgb(var(--fg)) 12%, transparent); border-radius: 12px;
      padding: 10px 12px; box-shadow: var(--shadow); font-size: 13px; line-height: 1.25;
      opacity: 0; pointer-events: none; transition: opacity .15s ease, transform .15s ease; transform-origin: bottom center; scale: .98;
      white-space: normal;
    }
    .tooltip:hover [data-tip]::after, .tooltip[data-open="true"] [data-tip]::after { opacity: 1; scale: 1; }

    /* Link chip */
    .link-chip { display:inline-flex; align-items:center; gap:8px; padding: 6px 10px; border-radius: 10px; text-decoration: none; border: 1px solid color-mix(in oklab, rgb(var(--fg)) 12%, transparent); }
    .link-chip:hover { background: rgba(255,255,255,.5); }
    @media (prefers-color-scheme: dark) { .link-chip:hover { background: rgba(255,255,255,.06); } }

    mark { background: color-mix(in oklab, rgb(var(--accent)) 25%, transparent); padding: 0 2px; border-radius: 2px; }
    .no-results { margin-top: 16px; }
    .footer { margin-top: 40px; font-size: 12px; color: rgb(var(--muted)); display:flex; gap:10px; align-items:center; }
    .kbd { font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace; font-size: 11px; border:1px solid color-mix(in oklab, rgb(var(--fg)) 12%, transparent); border-bottom-width: 2px; padding: 2px 6px; border-radius: 6px; }
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div class="logo" aria-hidden="true">
        <!-- simple zk swirl -->
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
          <path d="M3 12a9 9 0 1 0 9-9"/>
          <path d="M3 12h9V3"/>
        </svg>
      </div>
      <div>
        <h1>zksync‑wtf</h1>
        <div class="sub">Type to instantly look up addresses, hashes, opcodes, terms… from a tiny JSON.</div>
      </div>
    </header>

    <div class="search" role="search">
      <div class="input-shell" aria-label="Search input">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true"><circle cx="11" cy="11" r="8"/><path d="m21 21-3.5-3.5"/></svg>
        <input id="q" type="text" inputmode="search" placeholder="Search by key or value… (try: tx, 0xabc, nonce, 0xdead…)" autocomplete="off" spellcheck="false" aria-controls="results" />
        <span class="pill muted" id="count">0 items</span>
      </div>
      <div class="hint muted">Pro tip: press <span class="kbd">/</span> to focus search. Paste a hash, acronym, or term.</div>
    </div>

    <section class="results" id="results" aria-live="polite"></section>

    <div class="footer">
      <span>Data loads from JSON at page start. Provide <span class="kbd">?data=&lt;url&gt;</span> to override.</span>
    </div>
  </div>

  <!-- Embedded fallback JSON (small sample). Replace later or pass ?data=URL. -->
  <script type="application/json" id="seed-json">[
    {"key":"tx","value":"Ethereum transaction","description":"A signed instruction sent to the Ethereum network to update state.","url":"https://ethereum.org/en/developers/docs/transactions/"},
    {"key":"0x0000000000000000000000000000000000000000","value":"Zero address","description":"The burn/zero address used for minting or indicating 'no address'.","url":"https://ethereum.stackexchange.com/questions/851/"},
    {"key":"nonce","value":"Account nonce","description":"Number of transactions sent from an address (prevents replay).","url":"https://eips.ethereum.org/EIPS/eip-155"},
    {"key":"calldata","value":"Function call bytes","description":"Encoded function selector and args sent with a contract call.","url":"https://docs.soliditylang.org/en/latest/abi-spec.html"},
    {"key":"zksync","value":"ZK rollup network","description":"A rollup using zero-knowledge proofs to scale Ethereum.","url":"https://docs.zksync.io/"}
  ]</script>

  <template id="table-tpl">
    <table class="table" role="table" aria-label="Search results">
      <thead class="thead"><tr>
        <th style="width:42%">Key</th>
        <th style="width:32%">Value</th>
        <th style="width:26%">Actions</th>
      </tr></thead>
      <tbody class="tbody"></tbody>
    </table>
  </template>

  <script>
  ;(() => {
    const $ = sel => document.querySelector(sel);
    const $$ = sel => Array.from(document.querySelectorAll(sel));

    /** Load JSON from ?data=URL, otherwise from embedded <script id="seed-json"> */
    async function loadData() {
      const params = new URLSearchParams(location.search);
      const external = params.get('data');
      let items = [];
      try {
        if (external) {
          const res = await fetch(external, { cache: 'no-store' });
          if (!res.ok) throw new Error('Failed to fetch: ' + res.status);
          items = await res.json();
        } else {
          const raw = $('#seed-json')?.textContent?.trim() || '[]';
          items = JSON.parse(raw);
        }
      } catch (e) {
        console.error('JSON load error', e);
        items = [];
      }
      // normalize + index
      return items.map((r, i) => ({
        id: i,
        key: String(r.key ?? ''),
        value: String(r.value ?? ''),
        description: String(r.description ?? r.long ?? ''),
        url: r.url ?? r.link ?? null,
        key_lc: String(r.key ?? '').toLowerCase(),
        value_lc: String(r.value ?? '').toLowerCase(),
      }));
    }

    /** Simple ranking: exact > startsWith > substring; key beats value; then shorter index */
    function scoreRecord(rec, qlc) {
      if (!qlc) return 9999;
      const k = rec.key_lc, v = rec.value_lc;
      if (k === qlc) return 0;
      if (v === qlc) return 1;
      if (k.startsWith(qlc)) return 2;
      if (v.startsWith(qlc)) return 3;
      if (k.includes(qlc)) return 4 + k.indexOf(qlc)/1000;
      if (v.includes(qlc)) return 5 + v.indexOf(qlc)/1000;
      return 999;
    }

    /** Highlight simple substring matches (case-insensitive) */
    function hi(text, q) {
      if (!q) return escapeHtml(text);
      const rx = new RegExp('(' + escapeRegExp(q) + ')', 'ig');
      return escapeHtml(text).replace(rx, '<mark>$1</mark>');
    }

    function escapeHtml(s){ return s.replace(/[&<>"']/g, c=>({"&":"&amp;","<":"&lt;",">":"&gt;","\"":"&quot;","'":"&#39;"}[c])); }
    function escapeRegExp(s){ return s.replace(/[.*+?^${}()|[\]\\]/g, '\\$&'); }

    function renderTable(container, rows, q) {
      container.innerHTML = '';
      if (!rows.length) {
        container.innerHTML = `<div class="no-results muted">No results. Try another term.</div>`;
        return;
      }
      const tpl = document.getElementById('table-tpl');
      const table = tpl.content.cloneNode(true);
      const tbody = table.querySelector('.tbody');

      for (const r of rows) {
        const tr = document.createElement('tr');
        tr.innerHTML = `
          <td class="key">${hi(r.key, q)}</td>
          <td class="value">${hi(r.value, q)}</td>
          <td>
            <div style="display:flex; gap:8px; align-items:center; flex-wrap:wrap;">
              <span class="tooltip">
                <button class="btn-ghost" aria-label="More info" data-tip="${escapeHtml(r.description || 'No description')}">
                  ${icons.info}
                </button>
              </span>
              ${r.url ? `<a class="link-chip" href="${r.url}" target="_blank" rel="noopener noreferrer" aria-label="Open link">
                ${icons.link}<span class="muted" style="font-size:12px;">Open</span>
              </a>` : ''}
            </div>
          </td>`;
        tbody.appendChild(tr);
      }
      container.appendChild(table);

      // On mobile, allow tapping the info button to toggle tooltip pin
      tbody.addEventListener('click', (e) => {
        const btn = e.target.closest('.btn-ghost');
        if (!btn) return;
        const host = btn.closest('.tooltip');
        const open = host.getAttribute('data-open') === 'true';
        // close others
        $$('.tooltip[data-open="true"]').forEach(el => el.setAttribute('data-open','false'));
        host.setAttribute('data-open', open ? 'false' : 'true');
      });
      document.addEventListener('click', (e) => {
        if (!e.target.closest('.tooltip')) $$('.tooltip[data-open="true"]').forEach(el => el.setAttribute('data-open','false'));
      });
    }

    function formatCount(n){ return new Intl.NumberFormat().format(n) + ' items'; }

    // main
    let DATA = [];
    const resultsEl = document.getElementById('results');
    const input = document.getElementById('q');
    const count = document.getElementById('count');

    // keyboard focus shortcut
    window.addEventListener('keydown', (e)=>{ if (e.key === '/' && document.activeElement !== input) { e.preventDefault(); input.focus(); input.select(); } });

    function searchAndRender(q){
      const qlc = q.trim().toLowerCase();
      let rows = DATA;
      if (qlc) {
        rows = DATA
          .map(r => ({ r, s: scoreRecord(r, qlc) }))
          .filter(x => x.s < 999)
          .sort((a,b) => a.s - b.s || a.r.key.localeCompare(b.r.key))
          .map(x => x.r)
          .slice(0, 200);
      }
      renderTable(resultsEl, rows, q);
    }

    // debounce input
    let t = null;
    input.addEventListener('input', () => {
      clearTimeout(t);
      t = setTimeout(() => searchAndRender(input.value), 100);
    });

    // init
    loadData().then(items => {
      DATA = items;
      count.textContent = formatCount(DATA.length);
      searchAndRender('');
    });

    // icons
    const icons = {
      info: `<svg viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true"><circle cx="12" cy="12" r="9"/><path d="M12 8h.01"/><path d="M11 12h1v4h1"/></svg>`,
      link: `<svg viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true"><path d="M10 13a5 5 0 0 0 7.07 0l2.83-2.83a5 5 0 0 0-7.07-7.07L10 5"/><path d="M14 11a5 5 0 0 0-7.07 0L4.1 13.83a5 5 0 0 0 7.07 7.07L14 19"/></svg>`,
    };
  })();
  </script>
</body>
</html>

